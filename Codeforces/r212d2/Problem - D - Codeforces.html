<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="738gbg511h7f213594a836daec5e72g1">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="p2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-en.png">
    <meta property="og:title" content="Problem - D - Codeforces">
    <meta property="og:site_name" content="Codeforces">
    
    <meta name="cc" content="1rmo6tfz41jmb">
    <meta name="pc" content="m4zkj8w6dg6f">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Problem - D - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link href="Problem%20-%20D%20-%20Codeforces_files/font-awesome.css" rel="stylesheet">
    <link href="Problem%20-%20D%20-%20Codeforces_files/css.css" rel="stylesheet" type="text/css">

    

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<link href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<link href="Problem%20-%20D%20-%20Codeforces_files/prettify.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/clear.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/style_003.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/ttypography.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/problem-statement.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/second-level-menu.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/roundbox.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/datatable.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/topic.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/table-form.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/jquery_002.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/facebox.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/jquery_004.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/jquery_003.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/codeforces.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/colorbox.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/jquery.css" rel="stylesheet" type="text/css">
    
<link href="Problem%20-%20D%20-%20Codeforces_files/style_002.css" rel="stylesheet" type="text/css">
    
<link href="Problem%20-%20D%20-%20Codeforces_files/style.css" rel="stylesheet" type="text/css">

    
<script src="Problem%20-%20D%20-%20Codeforces_files/ga.js" async="" type="text/javascript"></script><script charset="utf-8" src="Problem%20-%20D%20-%20Codeforces_files/share.js" type="text/javascript"></script>
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<link charset="utf-8" href="Problem%20-%20D%20-%20Codeforces_files/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<script src="Problem%20-%20D%20-%20Codeforces_files/prettify.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery-1.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/sockjs-0.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/vertxbus-1.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_011.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_010.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/facebox.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_007.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/wysiwyg_003.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/wysiwyg_004.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/wysiwyg.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/wysiwyg_002.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_003.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_004.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_005.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_006.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_008.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_002.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/codeforces.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/jquery_009.js" type="text/javascript"></script>
    <script src="Problem%20-%20D%20-%20Codeforces_files/set.js" type="text/javascript"></script>
    <!--/CombineResourcesFilter-->
</head>
<body>


<span style="display:none;" class="csrf-token" data-csrf="738gbg511h7f213594a836daec5e72g1">&nbsp;</span>
<!-- Codeforces javascripts. -->

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();

        var count = 0;

        function getDelay() {
            var delay = 0;
            var last = Codeforces.getCookie("lastOnlineTimeUpdaterInvocation");
            if (last && last != null) {
                var period = count < 20 ? 180 * 1000 : 360 * 1000;
                delay = period - (new Date().getTime() - last);
                if (delay < 0)
                    delay = 0;
            }
            return delay;
        }

        window.setInterval(function() {
            if (getDelay() <= 0 && count < 120) {
                count++;
                Codeforces.ping("/data/update-online");
            }
        }, 5000);

        var handle = "sylap";
        $("a.rated-user:contains(" + handle + ")").each(function() {
            if ($(this).text() == handle) {
                var td = $(this).parent();
                var tr = $(this).parent().parent();
                if (td.is("td") && tr.is("tr")) {
                    tr.addClass("highlighted-row");
                }
            }
        });

        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">

<div id="header" style="position:relative;">
    <div style="float:left;">
            <a href="http://codeforces.com/"><img src="Problem%20-%20D%20-%20Codeforces_files/codeforces-logo-with-upper-beta.png"></a>
            <div style="position:absolute;left:147px;top:41px;">
                <a href="http://vk.com/" class="logo-href">Sponsored by <img style="position:relative;top:2px;" src="Problem%20-%20D%20-%20Codeforces_files/vkontakte-tiny-en.png"></a>
            </div>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="http://codeforces.com/contest/362/problem/D?locale=en"><img src="Problem%20-%20D%20-%20Codeforces_files/gb.png" title="In English" alt="In English"></a>
            <a href="http://codeforces.com/contest/362/problem/D?locale=ru"><img src="Problem%20-%20D%20-%20Codeforces_files/ru.png" title="По-русски" alt="По-русски"></a>
        </div>
        <div>
                <a href="http://codeforces.com/profile/sylap">sylap</a>
                 | 
                <a href="http://codeforces.com/fcaf91a958b4fbeacdce8bb6d7466d70/logout">Logout</a>
                
        </div>
    </div>
    <div style="font-size:0.8em;margin-top:0.25em;position:absolute;right:0;top:4.25em;">
    </div>
    <br style="clear: both;">
</div>
    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
            <div class="menu-list-container">

<ul class="menu-list main-menu-list">
        <li class=""><a href="http://codeforces.com/">Home</a></li>
        <li class="current"><a href="http://codeforces.com/contests">Contests</a></li>
        <li class=""><a href="http://codeforces.com/gyms">Gym</a></li>
        <li class=""><a href="http://codeforces.com/problemset">Problemset</a></li>
        <li class=""><a href="http://codeforces.com/ratings">Rating</a></li>
        <li class=""><a href="http://codeforces.com/help">Help</a></li>
        <li class=""><a href="http://codeforces.com/abbyycup30">ABBYY Cup 3.0 <img class="icon" src="Problem%20-%20D%20-%20Codeforces_files/cup.png"></a></li>
        <li class=""><a href="http://codeforces.com/icpc2013">ACM-ICPC WF-2013 <img class="icon" src="Problem%20-%20D%20-%20Codeforces_files/cup.png"></a></li>
        <li class=""><a href="http://codeforces.com/ya2013">Yandex.Algorithm 2013 <img class="icon" src="Problem%20-%20D%20-%20Codeforces_files/cup.png"></a></li>
</ul>
                <form method="post" action="/search"><input name="csrf_token" value="738gbg511h7f213594a836daec5e72g1" type="hidden">
                    <input class="search" name="query" data-isplaceholder="true" value="Search by tag">
                <input name="_tta" value="490" type="hidden"></form>
                <br style="clear: both;">
            </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            $("input.search").focus(function() {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        <br style="height:3em; clear: both;">
        <div style="position: relative;">
                <div id="sidebar">


    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;"><a style="color: black" href="http://codeforces.com/contest/362">Codeforces Round #212 (Div. 2)</a></th>
                </tr>
                    <tr>
                                <td class="left  dark" colspan="1"><span class="contest-state-phase">Contest is running</span></td>
                    </tr>
                    <tr>
                                <td class="left " colspan="1"><span cdid="i1" class="contest-state-regular countdown" home="http://worker.codeforces.ru/static" noredirection="true" textbeforeredirect="The coding phase of &quot;Codeforces Round #212 (Div. 2)&quot; is finished, reload the page to view changes">00:10:11</span></td>
                    </tr>
                    <tr>
                                <td class="left  dark" colspan="1"><span cdid="i2" class="contest-state-regular countdown" home="http://worker.codeforces.ru/static" noredirection="true" textbeforeredirect="The coding phase of &quot;Codeforces Round #212 (Div. 2)&quot; is finished, reload the page to view changes">Out of competition</span></td>
                    </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span cdid="i3" class="contest-state-regular countdown" home="http://worker.codeforces.ru/static" noredirection="true" textbeforeredirect="The coding phase of &quot;Codeforces Round #212 (Div. 2)&quot; is finished, reload the page to view changes"><center>
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="CONTEST" data-entityid="362" data-size="24" src="Problem%20-%20D%20-%20Codeforces_files/star_gray_24.png">
    </span>

    <script type="text/javascript">
        $(document).ready(function() {
            $("img.toggle-favourite").click(function() {
                var size = $(this).attr("data-size");
                var img = $(this);

                var isFavourite = !img.hasClass("remove-favourite");
                var type = img.attr("data-type");
                var entityId = img.attr("data-entityId");

                $.post("/data/favourite",
                        { entityId: entityId, type: type, isFavourite: isFavourite },
                        function(response) {
                            if (response["success"] != "true") {
                                alert(response["message"]);
                            } else {
                                if (img.hasClass("remove-favourite")) {
                                    img.attr("src", "http://worker.codeforces.ru/static/images/icons/star_gray_" + size + ".png");
                                    img.removeClass("remove-favourite");
                                    img.addClass("add-favourite");
                                } else {
                                    img.attr("src", "http://worker.codeforces.ru/static/images/icons/star_yellow_" + size + ".png");
                                    img.removeClass("add-favourite");
                                    img.addClass("remove-favourite");
                                }
                            }
                        }, "json"
                );

                return false;
            });
        });
    </script>
</center></span></td>
                    </tr>
            </tbody>
        </table>
    </div>


<style type="text/css">
    .submitForm .field {
        font-size: 11px;
        width: 3em !important;
        padding-right: 1em;
    }

    .submitForm input, .submitForm select {
        font-size: 11px;
        width: 17em;
    }
</style>
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Submit?
            <div class="top-links">
            </div>
        </div>
<div>
    <form method="post" action="?csrf_token=738gbg511h7f213594a836daec5e72g1" enctype="multipart/form-data" class="submitForm"><input name="csrf_token" value="738gbg511h7f213594a836daec5e72g1" type="hidden">
        <input name="action" value="submitSolutionFormSubmitted" type="hidden">
        <input name="submittedProblemIndex" value="D" type="hidden">
        <input name="source" value="" type="hidden">

        <table class="table-form" style="width:90%;">
            <tbody><tr>
                <td class="field">Language:</td>
                <td>
                    <select name="programTypeId">
                        <option value="10">GNU C 4</option>
                        <option value="1" selected="selected">GNU C++ 4.7</option>
                        <option value="16">GNU C++0x 4</option>
                        <option value="2">Microsoft Visual C++ 2010</option>
                        <option value="9">C# Mono 2.10</option>
                        <option value="29">MS C# .NET 4</option>
                        <option value="28">D DMD32 Compiler v2</option>
                        <option value="32">Go 1.1.1</option>
                        <option value="12">Haskell GHC 7.6</option>
                        <option value="5">Java 6</option>
                        <option value="23">Java 7</option>
                        <option value="19">OCaml 4</option>
                        <option value="3">Delphi 7</option>
                        <option value="4">Free Pascal 2</option>
                        <option value="13">Perl 5.8</option>
                        <option value="6">PHP 5.4</option>
                        <option value="7">Python 2.7</option>
                        <option value="31">Python 3.3</option>
                        <option value="8">Ruby 1.9</option>
                        <option value="20">Scala 2.9</option>
                    </select>
                </td>
            </tr>

            <tr>
                <td class="field">Choose file:</td>
                <td>
                    <input name="sourceFile" value="" type="file">
                </td>
            </tr>

            <tr>
                <td colspan="2">
                    <div style="text-align: center;">

                            <div style="font-size: 11px; width: 100%; margin: 0.5em auto;">
                                Be careful: there is 50 points penalty 
for submission which fails the pretests or resubmission (except failure 
on the first test, denial of judgement or similar verdicts). "Passed 
pretests" submission verdict doesn't guarantee that the solution is 
absolutely correct and it will pass system tests.
                            </div>


                        <input style="width:10em;" class="submit" value="Submit" type="submit">
                    </div>
                </td>
            </tr>
        </tbody></table>
    <input name="_tta" value="490" type="hidden"></form>
</div>
    </div>

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Score table
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;"></th>
                            <th class="" style="width:8em;">Score</th>
                </tr>
                    <tr>
                                <td class="left "><a href="http://codeforces.com/contest/362/problem/A">Problem A</a></td>
                                <td class="">1944</td>
                    </tr>
                    <tr>
                                <td class="left  dark"><a href="http://codeforces.com/contest/362/problem/B">Problem B</a></td>
                                <td class=" dark">972</td>
                    </tr>
                    <tr>
                                <td class="left "><a href="http://codeforces.com/contest/362/problem/C">Problem C</a></td>
                                <td class="">2916</td>
                    </tr>
                    <tr>
                                <td class="left  dark"><a href="http://codeforces.com/contest/362/problem/D">Problem D</a></td>
                                <td class=" dark">2916</td>
                    </tr>
                    <tr>
                                <td class="left "><a href="http://codeforces.com/contest/362/problem/E">Problem E</a></td>
                                <td class="">2916</td>
                    </tr>
                    <tr>
                                <td class="left  dark"><span style="color:green;">Successful hack</span></td>
                                <td class=" dark">100</td>
                    </tr>
                    <tr>
                                <td class="left "><span style="color:red;">Unsuccessful hack</span></td>
                                <td class="">-50</td>
                    </tr>
                    <tr>
                                <td class="left  dark"><span style="color:black;">Unsuccessful submission</span></td>
                                <td class=" dark">-50</td>
                    </tr>
                    <tr>
                                <td class="left bottom"><span style="color:black;">Resubmission</span></td>
                                <td class="bottom">-50</td>
                    </tr>
            </tbody>
        </table>
    </div>
<div style="text-align:right; position:relative;bottom:1.75em;">
    <span class="small" style="color:gray;">* If you solve problem on 00:07 from the first attempt</span>
</div>
                </div>
                <div id="content" class="content-with-sidebar">
                <div class="second-level-menu">
<ul class="second-level-menu-list"><li style="position: absolute; display: block; margin: 0px; padding: 0px; left: 0px; top: 0px; width: 76px; height: 20px; overflow: hidden;" class="backLava"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li class="current selectedLava"><a href="http://codeforces.com/contest/362">Problems</a></li>
        <li><a href="http://codeforces.com/contest/362/submit">Submit</a></li>
        <li><a href="http://codeforces.com/contest/362/my">My submissions</a></li>
        <li><a href="http://codeforces.com/contest/362/status">Status</a></li>
        <li><a href="http://codeforces.com/contest/362/hacks">Hacks</a></li>
        <li><a href="http://codeforces.com/contest/362/room/103">Room</a></li>
        <li><a href="http://codeforces.com/contest/362/standings">Standings</a></li>
        <li><a href="http://codeforces.com/contest/362/customtest">Custom test</a></li>
</ul>
</div>

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Fools and Foolproof Roads</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You
 must have heard all about the Foolland on your Geography lessons. 
Specifically, you must know that federal structure of this country has 
been the same for many centuries. The country consists of <span class="tex-span"><i>n</i></span> cities, some pairs of cities are connected by bidirectional roads, each road is described by its length <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>The
 fools lived in their land joyfully, but a recent revolution changed the
 king. Now the king is Vasily the Bear. Vasily divided the country 
cities into regions, so that any two cities of the same region have a 
path along the roads between them and any two cities of different 
regions don't have such path. Then Vasily decided to upgrade the road 
network and construct exactly <span class="tex-span"><i>p</i></span> new roads in the country. Constructing a road goes like this:</p><p></p><ol> <li> We choose a pair of <span class="tex-font-style-bf">distinct</span> cities <span class="tex-span"><i>u</i></span>, <span class="tex-span"><i>v</i></span> that will be connected by a new road (at that, it is possible that there already is a road between these cities). </li><li> We define the length of the new road: if cities <span class="tex-span"><i>u</i></span>, <span class="tex-span"><i>v</i></span> belong to distinct regions, then the length is calculated as <span class="tex-span"><i>min</i>(10<sup class="upper-index">9</sup>, <i>S</i> + 1)</span> (<span class="tex-span"><i>S</i></span> — the total length of all roads that exist in the linked regions), otherwise we assume that the length equals <span class="tex-span">1000</span>. </li><li>
 We build a road of the specified length between the chosen cities. If 
the new road connects two distinct regions, after construction of the 
road these regions are combined into one new region. </li></ol><p></p><p>Vasily wants the road constructing process to result in the country that consists exactly of <span class="tex-span"><i>q</i></span>
 regions. Your task is to come up with such road constructing plan for 
Vasily that it meets the requirement and minimizes the total length of 
the built roads.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains four integers <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>), <span class="tex-span"><i>m</i></span> (<span class="tex-span">0 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>), <span class="tex-span"><i>p</i></span> (<span class="tex-span">0 ≤ <i>p</i> ≤ 10<sup class="upper-index">5</sup></span>), <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>q</i> ≤ <i>n</i></span>)
 — the number of cities in the Foolland, the number of existing roads, 
the number of roads that are planned to construct and the required 
number of regions.</p><p>Next <span class="tex-span"><i>m</i></span> lines describe the roads that exist by the moment upgrading of the roads begun. Each of these lines contains three integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span>: <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> — the numbers of the cities connected by this road (<span class="tex-span">1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, <i>x</i><sub class="lower-index"><i>i</i></sub> ≠ <i>y</i><sub class="lower-index"><i>i</i></sub></span>), <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> — length of the road (<span class="tex-span">1 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup>)</span>. Note that one pair of cities can be connected with multiple roads.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If constructing the roads in the required way is impossible, print a single string "<span class="tex-font-style-tt">NO</span>" (without the quotes). Otherwise, in the first line print word "<span class="tex-font-style-tt">YES</span>" (without the quotes), and in the next <span class="tex-span"><i>p</i></span>
 lines print the road construction plan. Each line of the plan must 
consist of two distinct integers, giving the numbers of the cities 
connected by a road. The road must occur in the plan in the order they 
need to be constructed. If there are multiple optimal solutions, you can
 print any of them.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>9 6 2 2<br>1 2 2<br>3 2 1<br>4 6 20<br>1 3 8<br>7 8 3<br>5 7 2<br></pre></div><div class="output"><div class="title">Output</div><pre>YES<br>9 5<br>1 9<br></pre></div><div class="input"><div class="title">Input</div><pre>2 0 1 2<br></pre></div><div class="output"><div class="title">Output</div><pre>NO<br></pre></div><div class="input"><div class="title">Input</div><pre>2 0 0 2<br></pre></div><div class="output"><div class="title">Output</div><pre>YES<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Consider the first sample. Before the reform the Foolland consists of four regions. The first region includes cities <span class="tex-span">1</span>, <span class="tex-span">2</span>, <span class="tex-span">3</span>, the second region has cities <span class="tex-span">4</span> and <span class="tex-span">6</span>, the third region has cities <span class="tex-span">5</span>, <span class="tex-span">7</span>, <span class="tex-span">8</span>, the fourth region has city <span class="tex-span">9</span>. The total length of the roads in these cities is <span class="tex-span">11</span>, <span class="tex-span">20</span>, <span class="tex-span">5</span> and <span class="tex-span">0</span>, correspondingly. According to the plan, we first build the road of length <span class="tex-span">6</span> between cities <span class="tex-span">5</span> and <span class="tex-span">9</span>, then the road of length <span class="tex-span">23</span> between cities <span class="tex-span">1</span> and <span class="tex-span">9</span>. Thus, the total length of the built roads equals <span class="tex-span">29</span>.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
            </div>
        </div>
          <br style="clear:both;"> 
          <div id="footer">
               <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2013 Mike Mirzayanov</div>
               <div>The only programming contests Web 2.0 platform</div>
               
               <div>Server time: 11/14/2013 07:37PM (p2).</div>
          </div>
    <script type="text/javascript">
        $(document).ready(function() {
            Codeforces.focusOnError();
        });
    </script>
</div>

                                       
<div id="datepick-div" style="display: none;"></div><div style="display: none;" id="cboxOverlay"></div><div style="display: none; padding-bottom: 42px; padding-right: 42px;" class="" id="colorbox"><div id="cboxWrapper"><div><div style="float: left;" id="cboxTopLeft"></div><div style="float: left;" id="cboxTopCenter"></div><div style="float: left;" id="cboxTopRight"></div></div><div style="clear: left;"><div style="float: left;" id="cboxMiddleLeft"></div><div style="float: left;" id="cboxContent"><div style="width: 0px; height: 0px; overflow: hidden; float: left;" id="cboxLoadedContent"></div><div style="float: left;" id="cboxLoadingOverlay"></div><div style="float: left;" id="cboxLoadingGraphic"></div><div style="float: left;" id="cboxTitle"></div><div style="float: left;" id="cboxCurrent"></div><div style="float: left;" id="cboxNext"></div><div style="float: left;" id="cboxPrevious"></div><div style="float: left;" id="cboxSlideshow"></div><div style="float: left;" id="cboxClose"></div></div><div style="float: left;" id="cboxMiddleRight"></div></div><div style="clear: left;"><div style="float: left;" id="cboxBottomLeft"></div><div style="float: left;" id="cboxBottomCenter"></div><div style="float: left;" id="cboxBottomRight"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div></body></html>